@echo off
REM Simple PowerShell-based static server for Windows (serves current directory on port 8000)
powershell -NoProfile -Command "Add-Type -AssemblyName System.Net.HttpListener; $prefix='http://localhost:8000/'; $listener = New-Object System.Net.HttpListener; $listener.Prefixes.Add($prefix); $listener.Start(); Write-Host 'Serving' (Get-Location) 'on' $prefix; while ($listener.IsListening) { $context = $listener.GetContext(); $req = $context.Request; $path = $req.Url.LocalPath.TrimStart('/'); if ([string]::IsNullOrEmpty($path)) { $path='index.html' }; $file = Join-Path (Get-Location) $path; if (Test-Path $file) { $bytes = [System.IO.File]::ReadAllBytes($file); $context.Response.ContentLength64 = $bytes.Length; $context.Response.OutputStream.Write($bytes,0,$bytes.Length); $context.Response.OutputStream.Close(); } else { $context.Response.StatusCode = 404; $msg = '404 - Not Found'; $buf = [System.Text.Encoding]::UTF8.GetBytes($msg); $context.Response.ContentLength64 = $buf.Length; $context.Response.OutputStream.Write($buf,0,$buf.Length); $context.Response.OutputStream.Close(); } }"
pause
